% Introduction
\chapter{Introduction} 
\label{chapter:intro}

%PROBLEM

Geochemical modelling describes reactions that occur in a geological medium through the usage of chemical reactions and composition of the water. The need to understand the processes occurring between minerals that make up the sediment’s solid components and water that exist in between the minerals motivates the effort in this area of study. Applications of geochemical models are essential in several environmental problems, such as calculating the composition of natural waters, measuring flowing groundwater or surface water and the formation and dissolution of rocks and minerals in geologic formations. A geochemical speciation modelling software is responsible for calculating the distribution of dissolved species between solutes and aqueous complexes, and also computes saturation indexes for different minerals. 

%DEFINITION OF MODELLING

A mathematical model, as described in \cite{Sarker:08}, requires three major components: decision variables (unknowns of the model); objective function (which needs to be optimized); and constraints (restrictions or limitation of the model). 
The decision variables depend on the type of the problem considered.  The objective function represents the goal of the problem in term of decision variables. The constraints are the restrictions or limitations of the problem.

As stated in \cite{Drever:05}, a chemical model is a theoretical construct that permits the calculation of chemical properties and processes using thermodynamic properties of reactions between solutes. Following this idea, a geochemical model is a chemical model developed for geological systems. A set of mathematical expressions represents these natural processes. Thermodynamic data used to establish the reactions and mimic nature are directly responsible for the accuracy of the geochemical system modeled; while the numerical method and computational algorithms determines the precision of results obtained through the modeling.


%THIS WORK - MOTIVATION/CONTRIBUTION

In this work, a software is developed that calculates the chemical equilibrium of a geochemical system using the mass-balance conditions. This process is known as chemical speciation, and the software was named as \emph{SHPECK}. It accepts any general combination of elements, species, and reactions, allowing the user to create different environments, simulations and, therefore, fully control any aspect and configuration of the model. Also in this work, I show a thorough analysis of the available existing solutions, and I make clear the uniqueness of our computational approach to the geochemical modeling problem. 

I implemented \emph{SHPECK} using a high-level and object-oriented programming language to achieve an efficient solution method. \emph{SHPECK} provides an interactive and intuitive user interface as well as the support of a built-from-the-ground database structure that handles the management of the whole data used. The user interface included in the model is unique among geochemical speciation software, in that most do not provide one, or, if available, they are commercial products. These two contributions are presented as the result of an extensive study about the available software normally in use to perform geochemical speciation simulations. Computationally, other known models’ flow of information (input and output) are rigid and prone to error. It is also important to mention that these software are working with flat file databases. Both of these characteristics are responsible for frequent errors in both preparing data and viewing results. Therefore, \emph{SHPECK} is unique by combining the modern computing technology with an efficient numerical method.

%BASIC CONCEPTS USED

The principles of chemical equilibrium calculation rely on the law of conservation of mass (also known as the principle of mass conservation), stated by Antoine Lavoisier, and chemical speciation, which was presented by Garrels in \cite{Garrels:65}. 
The law of conservation of mass establishes that the total mass of an isolated system will remain constant and is independent of any chemical and physical changes taking place within the system. Therefore, the challenge of chemical equilibrium calculations is finding the number of moles that satisfies a system of equilibrium constraints at the moment where forward and reverse reactions rates are the same (equilibrium state). 
These constraints are organized in a form of linear conservation equations, which may be expressed in the form of either linear algebraic solute and charge balance equations or chemical equations \cite{SmithMissen83}. For the sake of simplicity, in this work I will only deal with chemical equilibrium and not with chemical kinetics calculations since the first one requires only the solution of algebraic equation. The kinetic aspect is planned for integration in the future.

%SOLVING METHOD

The system of equations drives and represents all the interactions between the components that make up the system, and is simulated by the program. By using the Newton-Raphson's solution method to that set of equations, it is possible to find a solution that satisfies the system of equations.  One must note that the initial guess is generated automatically and used as a seed for the iterations. 
This method requires the usage of a Jacobian matrix and a residual vector during the algebraic calculations. 


%Geochemical modelling speciation has an important application in processes that occur in turbidite reservoirs. 
%The process of the water coming from a salt dome contains a high concentration of salts as sodium (\ce{Na^+}), chlorine (\ce{Cl^-}) and potassium (\ce{K^+}). Compactation, cementation, dissolution or recrystalization can be observed inside turbidites when this process happens. These processes might change drastically, for example, the porosity of the rock and, therefore, the storage capacity of oil and gas.

%OBJECTIVES OF THIS WORK
\section{Objectives of this work}
%This work has as purpose two main objetives:
%This work has two objetives:
%\begin{enumerate}
%\item How to construct a geochemical speciation model and make %explicit the need and uniqueness of the approach used - \emph{SHPECK}. 
%\item Analysis, comparison, and evaluation of the accuracy of the model with available commercial options.
%\end{enumerate}

%\subsection{Emphasize the importance of geochemical speciation modelling}

Soils and aquifers are heterogeneous, subsurface systems composed of a large number of components - dissolved salts, minerals, metals, gases, natural organics, and microorganisms. Geochemical modeling is an important tool for understanding processes occurring in such systems. 


The main purpose of this work is to develop a geochemical speciation modelling software following a structured computational approach. The idea of our own geochemical speciation software has emerged as an application where it would be possible to add the benefits of smart user interface and efficient numerical method to the traditionally used method of speciation model development. The result is a compact and versatile tool with an intuitive and interactive user interface.

Therefore, I have made the necessary effort to understand and learn the complex aspects of a geochemical speciation model, and develop a software based on a solid knowledge in computer architecture, algorithms and software engineering. 

%STRUCTURE OF THIS WORK - TO BE VERIFIED AT THE END OF THE WORK
The rest of this report is structured as follows. In chapter 2, I present an overview of the basic concepts needed and technical concepts involved. Chapter 3 shows a thorough analysis and review of the commercial software available. Chapter 4 presents the \emph{SHPECK} implementation with a detailed description of the whole system: design options; mathematical treatment; implementation and graphical user interface (\emph{GUI}); algorithm validation and complexity; architecture and organization of the software as well as the database; data-flow; and iteration control. Chapter 5 presents a study case that validates \emph{SHPECK}, and makes a broad observation of the approach used in this work. Chapter 6 brings the conclusion of this work. %Finally, this work contains an Appendix A, which is a presentation and an analysis of a linear algebra library used for the development of \emph{SHPECK} called \emph{Armadillo C++} and appendix B, which is an automated analysis of \emph{SHPECK}'s database.